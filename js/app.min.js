"use strict";const Point={MIN:{propName:"--min-percent",costLimit:0,currentPercent:0},MAX:{propName:"--max-percent",costLimit:22059,currentPercent:68}},prevElement=document.querySelector("#filter-panel__cost-title-js"),minCost=document.querySelector("#cost-min-js"),maxCost=document.querySelector("#cost-max-js"),createElement=e=>{const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild},calculateCostValue=e=>Math.round(Point.MAX.costLimit*e.currentPercent/100),changeCostValue=(e,t)=>{e===Point.MIN?minCost.value=t:maxCost.value=t};if(prevElement&&minCost&&maxCost){let e=calculateCostValue(Point.MIN),t=calculateCostValue(Point.MAX);const n=createElement('\n    <div class="filter-panel__cost-range">\n      <div class="filter-panel__cost-range-line">\n        <div\n          class="filter-panel__cost-point filter-panel__cost-point--min"\n          tabindex="0"\n          id="filter-panel__cost-point-min-js"\n        ></div>\n        <div\n          class="filter-panel__cost-point filter-panel__cost-point--max"\n          tabindex="0"\n          id="filter-panel__cost-point-max-js"\n        ></div>\n      </div>\n    </div>\n  '),o=n.querySelector(".filter-panel__cost-range-line"),i=n.querySelector("#filter-panel__cost-point-min-js"),s=n.querySelector("#filter-panel__cost-point-max-js"),r=e=>{n.style.setProperty(e.propName,e.currentPercent+"%")},l=(e,t)=>{e.currentPercent=t,e===Point.MIN&&t>Point.MAX.currentPercent?(Point.MAX.currentPercent=t,r(Point.MAX),changeCostValue(Point.MAX,calculateCostValue(Point.MAX))):e===Point.MAX&&t<Point.MIN.currentPercent&&(Point.MIN.currentPercent=t,r(Point.MIN),changeCostValue(Point.MIN,calculateCostValue(Point.MIN)))},a=e=>{const t=e.target===minCost?Point.MIN:Point.MAX,n=Math.round(parseInt(e.target.value,10)/Point.MAX.costLimit*100);l(t,n),r(t)},c=e=>{const t=e.target===i?Point.MIN:Point.MAX,n=o.clientWidth,s=o.getBoundingClientRect().left,a=e=>{const o=Math.round((e.x-s)/n*100);o>=0&&o<=100&&(r(t),l(t,o),changeCostValue(t,calculateCostValue(t)))},c=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",c)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",c)};r(Point.MIN),r(Point.MAX),i.addEventListener("mousedown",c),s.addEventListener("mousedown",c),changeCostValue(Point.MIN,e),changeCostValue(Point.MAX,t),minCost.addEventListener("input",a),maxCost.addEventListener("input",a),prevElement.after(n)}const OPENED_CLASS="popup--opened",NO_JS_CLASS="popup--no-js",ERROR_CLASS="popup--error",ERROR_MESSAGE="Обязательное поле для заполнения",URL="https://echo.htmlacademy.ru/",popup=document.querySelector("#popup-js"),openPopupBtn=document.querySelector("#placement__description-button-js"),closePopupBtn=document.querySelector("#popup__close-button-js"),submitPopupFormBtn=document.querySelector("#popup__submit-js"),nameInput=document.querySelector("#popup-field-name-js"),emailInput=document.querySelector("#popup-field-email-js"),letterTextarea=document.querySelector("#popup-field-letter-js"),openPopup=e=>{e.preventDefault(),popup.classList.add(OPENED_CLASS),closePopupBtn.addEventListener("click",closePopup),submitPopupFormBtn.addEventListener("click",submitForm),nameInput.addEventListener("input",onFieldDataChanged),emailInput.addEventListener("input",onFieldDataChanged),letterTextarea.addEventListener("input",onFieldDataChanged)},closePopup=e=>{e&&e.preventDefault(),popup.classList.remove(OPENED_CLASS),popup.classList.remove(ERROR_CLASS),closePopupBtn.removeEventListener("click",closePopup),submitPopupFormBtn.removeEventListener("click",submitForm),nameInput.removeEventListener("input",onFieldDataChanged),emailInput.removeEventListener("input",onFieldDataChanged),letterTextarea.removeEventListener("input",onFieldDataChanged)},submitForm=e=>{e.preventDefault(),popup.classList.remove(ERROR_CLASS),isValidFormData()&&fetch(URL).then(e=>{if(!e.ok)throw popup.classList.add(ERROR_CLASS),new Error(`_${e.status}: ${e.statusText}`);return closePopup(),e}).catch(e=>{throw popup.classList.add(ERROR_CLASS),e})},isValidField=e=>e.value.length>0?(e.setCustomValidity(""),!0):(e.setCustomValidity(ERROR_MESSAGE),!1),isValidFormData=()=>isValidField(nameInput)&&isValidField(emailInput)&&isValidField(letterTextarea),onFieldDataChanged=e=>{isValidField(e.target)};popup&&openPopupBtn&&closePopupBtn&&submitPopupFormBtn&&(popup.classList.remove(NO_JS_CLASS),openPopupBtn.addEventListener("click",openPopup));const sliderContainer=document.querySelector(".principles");if(sliderContainer){const e="principles__slide--active",t="principles__control-button--active",n=e=>{const t=document.createElement("div");return t.innerHTML=e,t.firstChild},o=(o,i)=>{const s=n(`<li>\n        <button class="principles__control-button  ${i?"":t}" type="button">\n          <span class="visually-hidden">Принцип ${i+1}</span>\n        </button>\n      </li>`);return s.firstElementChild.addEventListener("click",n=>{const i=sliderContainer.querySelector("."+e);i!==o&&(sliderContainer.querySelector("."+t).classList.remove(t),i.classList.remove(e),o.classList.add(e),n.target.classList.add(t))}),i||o.classList.add(e),s},i=sliderContainer.querySelector("#principles__slider-js"),s=sliderContainer.querySelectorAll(".principles__slide"),r=n('<ul class="principles__control list-reset"></ul>');s.forEach((e,t)=>{e.classList.remove("principles__slide--no-js"),r.append(o(e,t))}),i.after(r)}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm11bHRpcGxlLXJhbmdlLmpzIiwicG9wdXAuanMiLCJzbGlkZXIuanMiXSwibmFtZXMiOlsiUG9pbnQiLCJNSU4iLCJwcm9wTmFtZSIsImNvc3RMaW1pdCIsImN1cnJlbnRQZXJjZW50IiwiTUFYIiwicHJldkVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtaW5Db3N0IiwibWF4Q29zdCIsImNyZWF0ZUVsZW1lbnQiLCJ0ZW1wbGF0ZSIsIndyYXBwZXIiLCJpbm5lckhUTUwiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNhbGN1bGF0ZUNvc3RWYWx1ZSIsInBvaW50IiwiTWF0aCIsInJvdW5kIiwiY2hhbmdlQ29zdFZhbHVlIiwibmV3VmFsdWUiLCJ2YWx1ZSIsImN1cnJlbnRNaW5WYWx1ZSIsImN1cnJlbnRNYXhWYWx1ZSIsInJhbmdlQmxvY2siLCJyYW5nZUxpbmUiLCJwb2ludE1pbiIsInBvaW50TWF4IiwiY2hhbmdlUHJvcFZhbHVlIiwic3R5bGUiLCJzZXRQcm9wZXJ0eSIsImNoYW5nZUN1cnJlbnRQZXJjZW50Iiwib25DaGFuZ2VDb3N0VmFsdWUiLCJldnQiLCJ0YXJnZXQiLCJuZXdQZXJjZW50IiwicGFyc2VJbnQiLCJvblBvaW50TW91c2VEb3duIiwiZG93bkV2dCIsImxpbmVXaWR0aCIsImNsaWVudFdpZHRoIiwibGVmdE9mZnNldCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImxlZnQiLCJvbk1vdmVQb2ludCIsIm1vdXNlRXZ0IiwiY3VycmVudFZhbHVlIiwieCIsIm9uVXBQb2ludCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiYWZ0ZXIiLCJPUEVORURfQ0xBU1MiLCJOT19KU19DTEFTUyIsIkVSUk9SX0NMQVNTIiwiRVJST1JfTUVTU0FHRSIsIlVSTCIsInBvcHVwIiwib3BlblBvcHVwQnRuIiwiY2xvc2VQb3B1cEJ0biIsInN1Ym1pdFBvcHVwRm9ybUJ0biIsIm5hbWVJbnB1dCIsImVtYWlsSW5wdXQiLCJsZXR0ZXJUZXh0YXJlYSIsIm9wZW5Qb3B1cCIsInByZXZlbnREZWZhdWx0IiwiY2xhc3NMaXN0IiwiYWRkIiwiY2xvc2VQb3B1cCIsInN1Ym1pdEZvcm0iLCJvbkZpZWxkRGF0YUNoYW5nZWQiLCJyZW1vdmUiLCJpc1ZhbGlkRm9ybURhdGEiLCJmZXRjaCIsInRoZW4iLCJyZXNwb25zZSIsIm9rIiwiRXJyb3IiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiY2F0Y2giLCJlcnJvciIsImlzVmFsaWRGaWVsZCIsImZpZWxkIiwibGVuZ3RoIiwic2V0Q3VzdG9tVmFsaWRpdHkiLCJzbGlkZXJDb250YWluZXIiLCJTTElERV9BQ1RJVkVfQ0xBU1MiLCJCVVRUT05fQUNUSVZFX0NMQVNTIiwibmV3RWxlbWVudCIsImZpcnN0Q2hpbGQiLCJjcmVhdGVTbGlkZXJCdXR0b24iLCJzbGlkZSIsIm51bWJlciIsImJ1dHRvbldyYXBwZXIiLCJjdXJyZW50U2xpZGUiLCJiZWZvcmVJbnNlcnRCbG9jayIsInNsaWRlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJidXR0b25zQ29udGFpbmVyIiwiZm9yRWFjaCIsImluZGV4IiwiYXBwZW5kIl0sIm1hcHBpbmdzIjoiQUFBQSxhQUVBLE1BQUFBLE1BQUEsQ0FDQUMsSUFBQSxDQUNBQyxTQUFBLGdCQUNBQyxVQUFBLEVBQ0FDLGVBQUEsR0FFQUMsSUFBQSxDQUNBSCxTQUFBLGdCQUNBQyxVQUFBLE1BQ0FDLGVBQUEsS0FJQUUsWUFBQUMsU0FBQUMsY0FBQSxnQ0FDQUMsUUFBQUYsU0FBQUMsY0FBQSxnQkFDQUUsUUFBQUgsU0FBQUMsY0FBQSxnQkFFQUcsY0FBQUMsSUFDQSxNQUFBQyxFQUFBTixTQUFBSSxjQUFBLE9BR0EsT0FGQUUsRUFBQUMsVUFBQUYsRUFFQUMsRUFBQUUsbUJBR0FDLG1CQUFBQyxHQUNBQyxLQUFBQyxNQUFBbkIsTUFBQUssSUFBQUYsVUFBQWMsRUFBQWIsZUFBQSxLQUdBZ0IsZ0JBQUEsQ0FBQUgsRUFBQUksS0FDQUosSUFBQWpCLE1BQUFD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REFFQW1GLEVBQUEsR0FBQUwsc0VBQ0FLLEVBQUEsNENBdUJBLE9BakJBQyxFQUFBaEYsa0JBQUFvQyxpQkFBQSxRQUFBakIsSUFDQSxNQUFBOEQsRUFBQVQsZ0JBQUEvRSxjQUFBLElBQUFnRixHQUVBUSxJQUFBSCxJQUNBTixnQkFBQS9FLGNBQUEsSUFBQWlGLEdBQ0F0QixVQUFBSyxPQUFBaUIsR0FDQU8sRUFBQTdCLFVBQUFLLE9BQUFnQixHQUVBSyxFQUFBMUIsVUFBQUMsSUFBQW9CLEdBQ0F0RCxFQUFBQyxPQUFBZ0MsVUFBQUMsSUFBQXFCLE1BSUFLLEdBQ0FELEVBQUExQixVQUFBQyxJQUFBb0IsR0FHQU8sR0FHQUUsRUFBQVYsZ0JBQUEvRSxjQUFBLDBCQUNBMEYsRUFBQVgsZ0JBQUFZLGlCQUFBLHNCQUVBQyxFQUFBekYsRUFBQSxvREFFQXVGLEVBQUFHLFFBQUEsQ0FBQVIsRUFBQVMsS0FDQVQsRUFBQTFCLFVBQUFLLE9BQUEsNEJBRUE0QixFQUFBRyxPQUFBWCxFQUFBQyxFQUFBUyxNQUlBTCxFQUFBN0MsTUFBQWdEIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IFBvaW50ID0ge1xuICBNSU46IHtcbiAgICBwcm9wTmFtZTogYC0tbWluLXBlcmNlbnRgLFxuICAgIGNvc3RMaW1pdDogMCxcbiAgICBjdXJyZW50UGVyY2VudDogMCxcbiAgfSxcbiAgTUFYOiB7XG4gICAgcHJvcE5hbWU6IGAtLW1heC1wZXJjZW50YCxcbiAgICBjb3N0TGltaXQ6IDIyMDU5LFxuICAgIGN1cnJlbnRQZXJjZW50OiA2OCxcbiAgfSxcbn07XG5cbmNvbnN0IHByZXZFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2ZpbHRlci1wYW5lbF9fY29zdC10aXRsZS1qc2ApO1xuY29uc3QgbWluQ29zdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNjb3N0LW1pbi1qc2ApO1xuY29uc3QgbWF4Q29zdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNjb3N0LW1heC1qc2ApO1xuXG5jb25zdCBjcmVhdGVFbGVtZW50ID0gKHRlbXBsYXRlKSA9PiB7XG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBkaXZgKTtcbiAgd3JhcHBlci5pbm5lckhUTUwgPSB0ZW1wbGF0ZTtcblxuICByZXR1cm4gd3JhcHBlci5maXJzdEVsZW1lbnRDaGlsZDtcbn07XG5cbmNvbnN0IGNhbGN1bGF0ZUNvc3RWYWx1ZSA9IChwb2ludCkgPT4ge1xuICByZXR1cm4gTWF0aC5yb3VuZChQb2ludC5NQVguY29zdExpbWl0ICogcG9pbnQuY3VycmVudFBlcmNlbnQgLyAxMDApO1xufTtcblxuY29uc3QgY2hhbmdlQ29zdFZhbHVlID0gKHBvaW50LCBuZXdWYWx1ZSkgPT4ge1xuICBpZiAocG9pbnQgPT09IFBvaW50Lk1JTikge1xuICAgIG1pbkNvc3QudmFsdWUgPSBuZXdWYWx1ZTtcbiAgfSBlbHNlIHtcbiAgICBtYXhDb3N0LnZhbHVlID0gbmV3VmFsdWU7XG4gIH1cbn07XG5cbmlmIChwcmV2RWxlbWVudCAmJiBtaW5Db3N0ICYmIG1heENvc3QpIHtcbiAgbGV0IGN1cnJlbnRNaW5WYWx1ZSA9IGNhbGN1bGF0ZUNvc3RWYWx1ZShQb2ludC5NSU4pO1xuICBsZXQgY3VycmVudE1heFZhbHVlID0gY2FsY3VsYXRlQ29zdFZhbHVlKFBvaW50Lk1BWCk7XG5cbiAgY29uc3QgbWFya3VwID0gKGBcbiAgICA8ZGl2IGNsYXNzPVwiZmlsdGVyLXBhbmVsX19jb3N0LXJhbmdlXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiZmlsdGVyLXBhbmVsX19jb3N0LXJhbmdlLWxpbmVcIj5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIGNsYXNzPVwiZmlsdGVyLXBhbmVsX19jb3N0LXBvaW50IGZpbHRlci1wYW5lbF9fY29zdC1wb2ludC0tbWluXCJcbiAgICAgICAgICB0YWJpbmRleD1cIjBcIlxuICAgICAgICAgIGlkPVwiZmlsdGVyLXBhbmVsX19jb3N0LXBvaW50LW1pbi1qc1wiXG4gICAgICAgID48L2Rpdj5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIGNsYXNzPVwiZmlsdGVyLXBhbmVsX19jb3N0LXBvaW50IGZpbHRlci1wYW5lbF9fY29zdC1wb2ludC0tbWF4XCJcbiAgICAgICAgICB0YWJpbmRleD1cIjBcIlxuICAgICAgICAgIGlkPVwiZmlsdGVyLXBhbmVsX19jb3N0LXBvaW50LW1heC1qc1wiXG4gICAgICAgID48L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICBgKTtcblxuICBjb25zdCByYW5nZUJsb2NrID0gY3JlYXRlRWxlbWVudChtYXJrdXApO1xuICBjb25zdCByYW5nZUxpbmUgPSByYW5nZUJsb2NrLnF1ZXJ5U2VsZWN0b3IoYC5maWx0ZXItcGFuZWxfX2Nvc3QtcmFuZ2UtbGluZWApO1xuICBjb25zdCBwb2ludE1pbiA9IHJhbmdlQmxvY2sucXVlcnlTZWxlY3RvcihgI2ZpbHRlci1wYW5lbF9fY29zdC1wb2ludC1taW4tanNgKTtcbiAgY29uc3QgcG9pbnRNYXggPSByYW5nZUJsb2NrLnF1ZXJ5U2VsZWN0b3IoYCNmaWx0ZXItcGFuZWxfX2Nvc3QtcG9pbnQtbWF4LWpzYCk7XG5cbiAgY29uc3QgY2hhbmdlUHJvcFZhbHVlID0gKHBvaW50KSA9PiB7XG4gICAgcmFuZ2VCbG9jay5zdHlsZS5zZXRQcm9wZXJ0eShwb2ludC5wcm9wTmFtZSwgYCR7cG9pbnQuY3VycmVudFBlcmNlbnR9JWApO1xuICB9O1xuXG4gIGNvbnN0IGNoYW5nZUN1cnJlbnRQZXJjZW50ID0gKHBvaW50LCBuZXdWYWx1ZSkgPT4ge1xuICAgIHBvaW50LmN1cnJlbnRQZXJjZW50ID0gbmV3VmFsdWU7XG5cbiAgICBpZiAocG9pbnQgPT09IFBvaW50Lk1JTiAmJiBuZXdWYWx1ZSA+IFBvaW50Lk1BWC5jdXJyZW50UGVyY2VudCkge1xuICAgICAgUG9pbnQuTUFYLmN1cnJlbnRQZXJjZW50ID0gbmV3VmFsdWU7XG4gICAgICBjaGFuZ2VQcm9wVmFsdWUoUG9pbnQuTUFYKTtcbiAgICAgIGNoYW5nZUNvc3RWYWx1ZShQb2ludC5NQVgsIGNhbGN1bGF0ZUNvc3RWYWx1ZShQb2ludC5NQVgpKTtcbiAgICB9IGVsc2UgaWYgKHBvaW50ID09PSBQb2ludC5NQVggJiYgbmV3VmFsdWUgPCBQb2ludC5NSU4uY3VycmVudFBlcmNlbnQpIHtcbiAgICAgIFBvaW50Lk1JTi5jdXJyZW50UGVyY2VudCA9IG5ld1ZhbHVlO1xuICAgICAgY2hhbmdlUHJvcFZhbHVlKFBvaW50Lk1JTik7XG4gICAgICBjaGFuZ2VDb3N0VmFsdWUoUG9pbnQuTUlOLCBjYWxjdWxhdGVDb3N0VmFsdWUoUG9pbnQuTUlOKSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IG9uQ2hhbmdlQ29zdFZhbHVlID0gKGV2dCkgPT4ge1xuICAgIGNvbnN0IHBvaW50ID0gZXZ0LnRhcmdldCA9PT0gbWluQ29zdFxuICAgICAgPyBQb2ludC5NSU5cbiAgICAgIDogUG9pbnQuTUFYO1xuXG4gICAgY29uc3QgbmV3UGVyY2VudCA9IE1hdGgucm91bmQoXG4gICAgICAgIHBhcnNlSW50KGV2dC50YXJnZXQudmFsdWUsIDEwKSAvIFBvaW50Lk1BWC5jb3N0TGltaXQgKiAxMDBcbiAgICApO1xuICAgIGNoYW5nZUN1cnJlbnRQZXJjZW50KHBvaW50LCBuZXdQZXJjZW50KTtcbiAgICBjaGFuZ2VQcm9wVmFsdWUocG9pbnQpO1xuICB9O1xuXG4gIGNvbnN0IG9uUG9pbnRNb3VzZURvd24gPSAoZG93bkV2dCkgPT4ge1xuICAgIGNvbnN0IHBvaW50ID0gZG93bkV2dC50YXJnZXQgPT09IHBvaW50TWluXG4gICAgICA/IFBvaW50Lk1JTlxuICAgICAgOiBQb2ludC5NQVg7XG4gICAgY29uc3QgbGluZVdpZHRoID0gcmFuZ2VMaW5lLmNsaWVudFdpZHRoO1xuICAgIGNvbnN0IGxlZnRPZmZzZXQgPSByYW5nZUxpbmUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcblxuICAgIGNvbnN0IG9uTW92ZVBvaW50ID0gKG1vdXNlRXZ0KSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSBNYXRoLnJvdW5kKChtb3VzZUV2dC54IC0gbGVmdE9mZnNldCkgLyBsaW5lV2lkdGggKiAxMDApO1xuICAgICAgaWYgKGN1cnJlbnRWYWx1ZSA+PSAwICYmIGN1cnJlbnRWYWx1ZSA8PSAxMDApIHtcbiAgICAgICAgY2hhbmdlUHJvcFZhbHVlKHBvaW50KTtcbiAgICAgICAgY2hhbmdlQ3VycmVudFBlcmNlbnQocG9pbnQsIGN1cnJlbnRWYWx1ZSk7XG4gICAgICAgIGNoYW5nZUNvc3RWYWx1ZShwb2ludCwgY2FsY3VsYXRlQ29zdFZhbHVlKHBvaW50KSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IG9uVXBQb2ludCA9ICgpID0+IHtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYG1vdXNlbW92ZWAsIG9uTW92ZVBvaW50KTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYG1vdXNldXBgLCBvblVwUG9pbnQpO1xuICAgIH07XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGBtb3VzZW1vdmVgLCBvbk1vdmVQb2ludCk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihgbW91c2V1cGAsIG9uVXBQb2ludCk7XG4gIH07XG5cbiAgY2hhbmdlUHJvcFZhbHVlKFBvaW50Lk1JTik7XG4gIGNoYW5nZVByb3BWYWx1ZShQb2ludC5NQVgpO1xuXG4gIHBvaW50TWluLmFkZEV2ZW50TGlzdGVuZXIoYG1vdXNlZG93bmAsIG9uUG9pbnRNb3VzZURvd24pO1xuICBwb2ludE1heC5hZGRFdmVudExpc3RlbmVyKGBtb3VzZWRvd25gLCBvblBvaW50TW91c2VEb3duKTtcblxuICBjaGFuZ2VDb3N0VmFsdWUoUG9pbnQuTUlOLCBjdXJyZW50TWluVmFsdWUpO1xuICBjaGFuZ2VDb3N0VmFsdWUoUG9pbnQuTUFYLCBjdXJyZW50TWF4VmFsdWUpO1xuXG4gIG1pbkNvc3QuYWRkRXZlbnRMaXN0ZW5lcihgaW5wdXRgLCBvbkNoYW5nZUNvc3RWYWx1ZSk7XG4gIG1heENvc3QuYWRkRXZlbnRMaXN0ZW5lcihgaW5wdXRgLCBvbkNoYW5nZUNvc3RWYWx1ZSk7XG5cbiAgcHJldkVsZW1lbnQuYWZ0ZXIocmFuZ2VCbG9jayk7XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbmNvbnN0IE9QRU5FRF9DTEFTUyA9IGBwb3B1cC0tb3BlbmVkYDtcbmNvbnN0IE5PX0pTX0NMQVNTID0gYHBvcHVwLS1uby1qc2A7XG5jb25zdCBFUlJPUl9DTEFTUyA9IGBwb3B1cC0tZXJyb3JgO1xuY29uc3QgRVJST1JfTUVTU0FHRSA9IGDQntCx0Y/Qt9Cw0YLQtdC70YzQvdC+0LUg0L/QvtC70LUg0LTQu9GPINC30LDQv9C+0LvQvdC10L3QuNGPYDtcbmNvbnN0IFVSTCA9IGBodHRwczovL2VjaG8uaHRtbGFjYWRlbXkucnUvYDtcblxuY29uc3QgcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcG9wdXAtanNgKTtcbmNvbnN0IG9wZW5Qb3B1cEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGFjZW1lbnRfX2Rlc2NyaXB0aW9uLWJ1dHRvbi1qc2ApO1xuY29uc3QgY2xvc2VQb3B1cEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwb3B1cF9fY2xvc2UtYnV0dG9uLWpzYCk7XG5jb25zdCBzdWJtaXRQb3B1cEZvcm1CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcG9wdXBfX3N1Ym1pdC1qc2ApO1xuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BvcHVwLWZpZWxkLW5hbWUtanNgKTtcbmNvbnN0IGVtYWlsSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcG9wdXAtZmllbGQtZW1haWwtanNgKTtcbmNvbnN0IGxldHRlclRleHRhcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BvcHVwLWZpZWxkLWxldHRlci1qc2ApO1xuXG5jb25zdCBvcGVuUG9wdXAgPSAoZXZ0KSA9PiB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIHBvcHVwLmNsYXNzTGlzdC5hZGQoT1BFTkVEX0NMQVNTKTtcblxuICBjbG9zZVBvcHVwQnRuLmFkZEV2ZW50TGlzdGVuZXIoYGNsaWNrYCwgY2xvc2VQb3B1cCk7XG4gIHN1Ym1pdFBvcHVwRm9ybUJ0bi5hZGRFdmVudExpc3RlbmVyKGBjbGlja2AsIHN1Ym1pdEZvcm0pO1xuICBuYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihgaW5wdXRgLCBvbkZpZWxkRGF0YUNoYW5nZWQpO1xuICBlbWFpbElucHV0LmFkZEV2ZW50TGlzdGVuZXIoYGlucHV0YCwgb25GaWVsZERhdGFDaGFuZ2VkKTtcbiAgbGV0dGVyVGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcihgaW5wdXRgLCBvbkZpZWxkRGF0YUNoYW5nZWQpO1xufTtcblxuY29uc3QgY2xvc2VQb3B1cCA9IChldnQpID0+IHtcbiAgaWYgKGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG5cbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShPUEVORURfQ0xBU1MpO1xuICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKEVSUk9SX0NMQVNTKTtcblxuICBjbG9zZVBvcHVwQnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoYGNsaWNrYCwgY2xvc2VQb3B1cCk7XG4gIHN1Ym1pdFBvcHVwRm9ybUJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKGBjbGlja2AsIHN1Ym1pdEZvcm0pO1xuICBuYW1lSW5wdXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihgaW5wdXRgLCBvbkZpZWxkRGF0YUNoYW5nZWQpO1xuICBlbWFpbElucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXIoYGlucHV0YCwgb25GaWVsZERhdGFDaGFuZ2VkKTtcbiAgbGV0dGVyVGV4dGFyZWEucmVtb3ZlRXZlbnRMaXN0ZW5lcihgaW5wdXRgLCBvbkZpZWxkRGF0YUNoYW5nZWQpO1xufTtcblxuY29uc3Qgc3VibWl0Rm9ybSA9IChldnQpID0+IHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShFUlJPUl9DTEFTUyk7XG5cbiAgaWYgKGlzVmFsaWRGb3JtRGF0YSgpKSB7XG4gICAgZmV0Y2goVVJMKVxuICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKEVSUk9SX0NMQVNTKTtcblxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgXyR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xvc2VQb3B1cCgpO1xuXG4gICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoRVJST1JfQ0xBU1MpO1xuXG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfSk7XG4gIH1cbn07XG5cbmNvbnN0IGlzVmFsaWRGaWVsZCA9IChmaWVsZCkgPT4ge1xuICBpZiAoZmllbGQudmFsdWUubGVuZ3RoID4gMCkge1xuICAgIGZpZWxkLnNldEN1c3RvbVZhbGlkaXR5KGBgKTtcblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZmllbGQuc2V0Q3VzdG9tVmFsaWRpdHkoRVJST1JfTUVTU0FHRSk7XG5cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuY29uc3QgaXNWYWxpZEZvcm1EYXRhID0gKCkgPT4ge1xuICByZXR1cm4gaXNWYWxpZEZpZWxkKG5hbWVJbnB1dClcbiAgICAmJiBpc1ZhbGlkRmllbGQoZW1haWxJbnB1dClcbiAgICAmJiBpc1ZhbGlkRmllbGQobGV0dGVyVGV4dGFyZWEpO1xufTtcblxuY29uc3Qgb25GaWVsZERhdGFDaGFuZ2VkID0gKGV2dCkgPT4ge1xuICBpc1ZhbGlkRmllbGQoZXZ0LnRhcmdldCk7XG59O1xuXG5pZiAocG9wdXAgJiYgb3BlblBvcHVwQnRuICYmIGNsb3NlUG9wdXBCdG4gJiYgc3VibWl0UG9wdXBGb3JtQnRuKSB7XG4gIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoTk9fSlNfQ0xBU1MpO1xuICBvcGVuUG9wdXBCdG4uYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCBvcGVuUG9wdXApO1xufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBzbGlkZXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAucHJpbmNpcGxlc2ApO1xuXG5pZiAoc2xpZGVyQ29udGFpbmVyKSB7XG4gIGNvbnN0IFNMSURFX0FDVElWRV9DTEFTUyA9IGBwcmluY2lwbGVzX19zbGlkZS0tYWN0aXZlYDtcbiAgY29uc3QgQlVUVE9OX0FDVElWRV9DTEFTUyA9IGBwcmluY2lwbGVzX19jb250cm9sLWJ1dHRvbi0tYWN0aXZlYDtcblxuICBjb25zdCBjcmVhdGVFbGVtZW50ID0gKHRlbXBsYXRlKSA9PiB7XG4gICAgY29uc3QgbmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYGRpdmApO1xuICAgIG5ld0VsZW1lbnQuaW5uZXJIVE1MID0gdGVtcGxhdGU7XG4gICAgcmV0dXJuIG5ld0VsZW1lbnQuZmlyc3RDaGlsZDtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVTbGlkZXJCdXR0b24gPSAoc2xpZGUsIG51bWJlcikgPT4ge1xuICAgIGNvbnN0IGJ1dHRvblRlbXBsYXRlID0gKFxuICAgICAgYDxsaT5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInByaW5jaXBsZXNfX2NvbnRyb2wtYnV0dG9uICAke251bWJlciA/IGBgIDogQlVUVE9OX0FDVElWRV9DTEFTU31cIiB0eXBlPVwiYnV0dG9uXCI+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJ2aXN1YWxseS1oaWRkZW5cIj7Qn9GA0LjQvdGG0LjQvyAke251bWJlciArIDF9PC9zcGFuPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgIDwvbGk+YFxuICAgICk7XG5cbiAgICBjb25zdCBidXR0b25XcmFwcGVyID0gY3JlYXRlRWxlbWVudChidXR0b25UZW1wbGF0ZSk7XG4gICAgYnV0dG9uV3JhcHBlci5maXJzdEVsZW1lbnRDaGlsZC5hZGRFdmVudExpc3RlbmVyKGBjbGlja2AsIChldnQpID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRTbGlkZSA9IHNsaWRlckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKGAuJHtTTElERV9BQ1RJVkVfQ0xBU1N9YCk7XG5cbiAgICAgIGlmIChjdXJyZW50U2xpZGUgIT09IHNsaWRlKSB7XG4gICAgICAgIHNsaWRlckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKGAuJHtCVVRUT05fQUNUSVZFX0NMQVNTfWApXG4gICAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoQlVUVE9OX0FDVElWRV9DTEFTUyk7XG4gICAgICAgIGN1cnJlbnRTbGlkZS5jbGFzc0xpc3QucmVtb3ZlKFNMSURFX0FDVElWRV9DTEFTUyk7XG5cbiAgICAgICAgc2xpZGUuY2xhc3NMaXN0LmFkZChTTElERV9BQ1RJVkVfQ0xBU1MpO1xuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5hZGQoQlVUVE9OX0FDVElWRV9DTEFTUyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAoIW51bWJlcikge1xuICAgICAgc2xpZGUuY2xhc3NMaXN0LmFkZChTTElERV9BQ1RJVkVfQ0xBU1MpO1xuICAgIH1cblxuICAgIHJldHVybiBidXR0b25XcmFwcGVyO1xuICB9O1xuXG4gIGNvbnN0IGJlZm9yZUluc2VydEJsb2NrID0gc2xpZGVyQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoYCNwcmluY2lwbGVzX19zbGlkZXItanNgKTtcbiAgY29uc3Qgc2xpZGVzID0gc2xpZGVyQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoYC5wcmluY2lwbGVzX19zbGlkZWApO1xuXG4gIGNvbnN0IGJ1dHRvbnNDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KGA8dWwgY2xhc3M9XCJwcmluY2lwbGVzX19jb250cm9sIGxpc3QtcmVzZXRcIj48L3VsPmApO1xuXG4gIHNsaWRlcy5mb3JFYWNoKChzbGlkZSwgaW5kZXgpID0+IHtcbiAgICBzbGlkZS5jbGFzc0xpc3QucmVtb3ZlKGBwcmluY2lwbGVzX19zbGlkZS0tbm8tanNgKTtcblxuICAgIGJ1dHRvbnNDb250YWluZXIuYXBwZW5kKGNyZWF0ZVNsaWRlckJ1dHRvbihzbGlkZSwgaW5kZXgpKTtcbiAgfSk7XG5cblxuICBiZWZvcmVJbnNlcnRCbG9jay5hZnRlcihidXR0b25zQ29udGFpbmVyKTtcbn1cbiJdfQ==
